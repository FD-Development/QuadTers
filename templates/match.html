{%  extends "base.html" %}

{% block title %} Match - QuadTers {% endblock %}
{% block content %}
    <meta http-equiv="refresh" content="5;URL=/match" />
    <div id="ui">

        {# Board #}

    <table id="gameboard">
        {% for y in range(8) %}
        <tr>
            {% for x in range(10) %}
            <td>

                {# Tile info #}
                {{game.board.gameboard[y][x][0]}}
                {# Powerup info #}
				{% if game.board.gameboard[y][x][2] %}
                    <div class="powerup" style="color:orange" ></div>
                {% endif %}
                {# Tile - available movement #}
                {% if (y,x) in movement%}
                    <form method="post">
                    <input type="hidden" name='action' value='move'>
                    <input type="hidden" name='y' value={{ y }}>
                    <input type="hidden" name='x' value={{ x }}>
                    <input type="submit" value="MOVE" >
                    </form>
                {% endif %}


                {# Pawn info/color #}
                {% if game.board.gameboard[y][x][1] %}

                    {# Player distinction #}
                    {% if game.board.gameboard[y][x][1].owner == game.players[0] %}
                        <form id="player0"
                    {% else %}
                        <form id="player1"
                    {% endif %}
                    {% if game.board.gameboard[y][x][1].collected_powerups  %}
                        class="has_powerup"
                    {% endif %}
                            method="post">

                    {# Pawn selection #}
                            <input type="hidden" name='y' value={{ y }}>
                            <input type="hidden" name='x' value={{ x }}>

                        {% if game.board.gameboard[y][x][1] == selected %}
                            <input type="hidden" name='action' value='deselect'>
                            <input class="pawn" style="background-color:green" type="submit" value="+">
                        {% elif game.board.gameboard[y][x][1].owner == turn %}
                            <input type="hidden" name='action' value='select'>
                            <input class="pawn"  type="submit" value="+" >
                        {% else %}
                            <input class="pawn" type="button">
                        {% endif %}
                    </form>

                {% endif %}
				
            </td>
            {% endfor %}
        </tr>
        {% endfor %}
    </table>

    {# Powerup #}
    <div id="side-panel" >
        <div id="collected_powers">
        {% if selected %}
            <ul>
            {% for power in selected.collected_powerups %}
                <li>
                    <dl>
                        <div>
                            <dt><a>{{ selected.powerups.description_dict[ power ][0] }} : {{ selected.collected_powerups.get(power) }} </a></dt>
                            <form method="post">
                                <input type="hidden" name="action" value="powerup" >
                                <input type="hidden" name="powerup" value="{{ power }}" >
                                <input type="submit" value="ACTIVATE" >
                            </form>
                        </div>
                        <dd>{{ selected.powerups.description_dict[ power ][1] }}</dd>
                    </dl>

                </li>
            {% endfor %}
            </ul>
        {% endif %}
        </div>
        <!--<div id="all_powers"><div>-->
    </div>

    </div>
{% endblock %}

{% block footer %}
    {# DEBUG Info #}
    <a> {{ movement }} | {{ game.selected }} | {{ turn.name }}</a>
{% endblock %}



